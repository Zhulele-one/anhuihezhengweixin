<!DOCTYPE html>
<html lang="en"  xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Basic -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- Site Metas -->
    <title th:text="${HTML.title}"></title>
    <meta name="keywords" content="安徽和正工程咨询有限公司,和正造价,安徽工程咨询公司">
    <meta name="description" content="安徽和正工程咨询有限公司始建于2016年9月，是一家具有独立法人资格的、新型的现代化企业制公司，企业注册资本1000万元人民币。">
    <meta name="author" content="安徽和正工程咨询有限公司">

    <!-- Site Icons -->
    <link rel="shortcut icon" th:href="@{/hezheng/images/favicon.ico}" type="image/x-icon" />
    <link rel="apple-touch-icon" th:href="@{/hezheng/images/apple-touch-icon.png}">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" th:href="@{/hezheng/css/bootstrap.min.css}">
    <!-- Site CSS -->
    <link rel="stylesheet" th:href="@{/hezheng/style.css}">
    <!-- ALL VERSION CSS -->
    <link rel="stylesheet" th:href="@{/hezheng/css/versions.css}">
    <!-- Responsive CSS -->
    <link rel="stylesheet" th:href="@{/hezheng/css/responsive.css}">
    <!-- Custom CSS -->
    <link rel="stylesheet" th:href="@{/hezheng/css/custom.css}">
    <link rel="stylesheet" th:href="@{/hezheng/css/page.css}">
    <link rel="stylesheet" th:href="@{/hezheng/css/mStyle.css}">

    <!--[if lt IE 9]>
    <script th:src="@{https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js}"></script>
    <script th:src="@{https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js}"></script>
    <![endif]-->

</head>
<body class="politics_version">


<div th:insert="~{head/header :: headerFragment}"></div>
<div th:insert="~{head/header :: titleFragment}"></div>


<div id="about" class="section wb hidden-xs hidden-sm">
    <div class="container">
        <div class="row">
            <div class="col-md-3 hidden-xs hidden-sm">
                <div th:insert="~{body/body :: sideFragment}"></div>
            </div><!-- end col -->

            <div class="col-md-9 m40">
                <div class="message-box">
                    <div th:insert="~{body/body :: titleFragment}"></div>
                    <div class="row">
                        <a class="btn btn-sm btn-primary" style="float:right;margin-right:50px"  th:href="@{/preview/addPage/}+${HTML.textEntity.id}">新建</a>
                        <a class="btn btn-sm btn-primary" style="float:right; margin-right:10px"  th:href="@{/recruit/seeRecruitForm/1}">查看招聘数据</a>
                    </div>
                    <div class="row" th:each="item:${HTML.textEntity.content}">
                        <div class="bottom-line"></div>
                        <div class="col-xs-12 col-sm-12 shownTab">
                            <div class="mlink">
                                <span class="left" style="margin-left: 5px; font-size: 18px;color: black" th:text="${item.name}">造价员</span>
                                <i style="float: right;margin-top: 10px;margin-right: 10px;" class="fa fa-chevron-down"></i>
                                <button style="float: right;margin-right: 10px;" class="btn btn-sm delBtn btn-primary" th:attr="del_uri=@{/preview/deleteRecruit/}+${item.id}">删除</button>
                                <a style="float: right ;margin-right: 10px;"  class="btn btn-sm btn-primary" th:href="@{/preview/editPage/}+${item.textId}+@{/1}">编辑</a>
                            </div>
                            <div class="msubmenu popover-content" style="display: none">
                                <div class="row m10">
                                    <div class="text-left">
                                        <small th:text="${item.abstractText}">安徽和正工程咨询有限公司是一家新型的现代化企业制公司，主要从事招标代理、工程造价、工程监理、工程设计、财务审计等技术服务工作。现向社会及大专、本科院校招聘以下岗位人员：</small>
                                        <div class="recruitMsg" style="color: black;" th:attr="recruit_msg=${item.url}"></div>
                                    </div>
                                    <hr>
                                    <div class="text-right">
                                        <!--http://localhost:8080/houtai/recruit/recruitForm/330-->
                                        <a th:href="@{/recruit/recruitForm/}+${item.textId}"><button class="btn-danger btn btn-lg">申请职位</button></a>
                                    </div>
                                </div><!-- end row -->
                            </div>
                        </div>
                    </div><!-- end row -->
                    <br>
                    <div class="row">
                        <div>
                            <div id="pager" class="pager clearfix">
                            </div>
                        </div>
                    </div>
                </div><!-- end messagebox -->
            </div><!-- end col -->
            <hr>
        </div><!-- end row -->
    </div><!-- end container -->
</div><!-- end section -->


<div class="container-fluid visible-sm visible-xs">
    <div class="row">
        <div class="col-md-12 col-xs-12 m40">
            <div class="message-box">
                <h2 th:text="${HTML.textEntity.title}">招贤纳士</h2>
                <h4 class="caseu" th:text="${HTML.textEntity.alia}">Company Recruit</h4>
                <div class="row" th:each="item:${HTML.textEntity.content}">
                    <div class="bottom-line"></div>
                    <div class="col-xs-12 col-sm-12 shownTab">
                        <div class="mlink">
                            <span class="left" style="margin-left: 5px; font-size: 18px;color: black" th:text="${item.name}">造价员</span>
                            <i style="float: right;margin-top: 10px;margin-right: 10px;" class="fa fa-chevron-down"></i>
                        </div>
                        <div class="msubmenu popover-content" style="display: none">
                            <div class="row m10">
                                <div class="text-left">
                                    <small th:text="${item.abstractText}">安徽和正工程咨询有限公司是一家新型的现代化企业制公司，主要从事招标代理、工程造价、工程监理、工程设计、财务审计等技术服务工作。现向社会及大专、本科院校招聘以下岗位人员：</small>
                                    <div class="recruitMsg" style="color: black;" th:attr="recruit_msg=${item.url}"></div>
                                </div>
                                <hr>
                                <div class="text-right">
                                    <!--http://localhost:8080/houtai/recruit/recruitForm/330-->
                                    <a th:href="@{/recruit/recruitFormUrl/}+${item.textId}"><button class="btn-danger btn btn-lg">申请职位</button></a>
                                    <!--<a th:href="${item.url}"><button class="btn-danger btn btn-lg">申请职位</button></a>-->
                                </div>
                            </div><!-- end row -->
                        </div>
                    </div>
                </div><!-- end row -->

            </div><!-- end messagebox -->
        </div><!-- end col -->
        <hr>
    </div><!-- end row -->
</div><!-- end container -->




<div th:insert="~{head/footer :: footerFragment}"></div>
<div th:insert="~{head/footer :: sidebarFragment}"></div>
<div th:insert="~{head/footer :: totopFragment}"></div>
<div th:insert="~{head/resource :: jsFragment}"></div>


<script>




    $('.btn-primary').css('display','none')

    let totalData= [[${pageable == null? 10:pageable.totalElements}]];//总条数
    let pageData= [[${pageable == null? 10:pageable.size}]]; //每页条数
    let pageCount=[[${pageable == null? 10:pageable.totalPages}]];//总页数
    let current= [[${pageable == null ? 1:pageable.number+1}]];//当前页数
    let pageStep= 8; //当前可见最多页码个数
    let minPage= 5; //最小页码数，页码小于此数值则不显示上下分页按钮
    let btnShow= true;
    let ajaxSetData= false;

    $("#pager").zPager({
        totalData:totalData,//总条数
        pageData: pageData, //每页条数
        pageCount:pageCount,//总页数
        current:current,//当前页数
        pageStep: pageStep, //当前可见最多页码个数
        minPage: minPage, //最小页码数，页码小于此数值则不显示上下分页按钮
        btnShow: btnShow,
        ajaxSetData: ajaxSetData
    });


    $(function () {
        $('.pager a').click(function () {
            console.log($(this).attr('disabled'))
            if($(this).attr('disabled') == 'disabled'){
                return false;
            }
            let url = window.location.href
            console.log(url)
            let cutPoint = url.lastIndexOf("/")
            console.log($(this).html())
            let nextUrl = url.substr(0,cutPoint) + "/" + $(this).attr('page-id')
            console.log(nextUrl)
            window.location.href = nextUrl

        })
    });


    function currentPage(currentPage){

        console.log("当前页码数：" + currentPage);
    }


    let startUrl =  "[[${#httpServletRequest.getScheme() + '://' + #httpServletRequest.getServerName() + ':' + #httpServletRequest.getServerPort() + #httpServletRequest.getContextPath()}]]"


    $(function() {
        var Accordion = function(el, multiple) {
            this.el = el || {};
            this.multiple = multiple || false;

            // Variables privadas
            var links = this.el.find('.mlink');
            // Evento
            links.on('click', {el: this.el, multiple: this.multiple}, this.dropdown)
        }

        Accordion.prototype.dropdown = function(e) {
            var $el = e.data.el;
            $this = $(this),
                $next = $this.next();

            $next.stop().slideToggle();
            $this.parent().toggleClass('open');

            let msgDiv = $next.find($('.recruitMsg'));
            let msgUrl = msgDiv.attr('recruit_msg');
            console.log('msgurl' + msgUrl)
            console.log(msgDiv)
            let url = startUrl + msgUrl
            $.ajax({
                type:"GET",
                url:url,
                dataType:"json",
                success:function(data){
                    msgDiv.html(data.msg)
                },
                error:function(jqXHR){
                    msgDiv.html("获取招聘信息失败,网络可能有错误")
                }
            });


            if (!e.data.multiple) {
                $el.find('.msubmenu').not($next).stop().slideUp().parent().removeClass('open');
            };
        }

        var shownTab = new Accordion($('.shownTab'), false);
    });


    $(function () {
        $('.delBtn').click(function () {
            let url = $(this).attr('del_uri');
            console.log(url);
            swal({
                title:"你确定要删除吗,删除后其对应的岗位也会删除",
                icon: "info",
                buttons: ["取消","确定"],
                dangerMode: true,
            }).then((willSubmit) => {
                if (willSubmit) {
                    console.log($('#editable').html());
                    $.ajax({
                        type:"GET",
                        url:url,
                        dataType:"json",
                        success:function(data){
                            if(data.code){
                                swal({
                                    title: "删除成功",
                                    text: data.msg,
                                    icon: "success",
                                    button: "确定",
                                }).then((value) => {
                                    window.location.reload()
                                });
                            }else{
                                swal({
                                    title: "删除失败",
                                    text: data.msg,
                                    icon: "info",
                                    button: "确定",
                                });
                            }
                        },
                        error:function(jqXHR){
                            swal({
                                title: "生成",
                                text: "出错了!链接中断",
                                icon: "error",
                                button: "确定",
                            });
                        }
                    });
                }
            });
        })
    })

</script>
</body>
</html>
